<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏à‡πâ‡∏á‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</title>
</head>
<body>
  <h2>‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏à‡πâ‡∏á‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</h2>

  <form id="serviceForm">
    <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó:</label><br>
    <input type="text" name="company" required><br><br>

    <label>‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠:</label><br>
    <input type="text" name="contact" required><br><br>

    <label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå:</label><br>
    <input type="tel" name="phone" required><br><br>

    <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏á‡∏≤‡∏ô:</label><br>
    <input type="text" name="jobType" required><br><br>

    <label>‡∏•‡∏¥‡∏á‡∏Å‡πå Google Maps (‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏´‡∏ô‡πâ‡∏≤‡∏á‡∏≤‡∏ô):</label><br>
    <input type="url" name="mapLink" id="mapLinkInput" required>
    <button type="button" onclick="getCurrentLocation()">üìç ‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</button>
    <button type="button" onclick="openMap()">üó∫Ô∏è ‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á</button><br><br>

    <label>‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠:</label><br>
    <input type="file" id="mediaFile" accept="image/*,video/*"><br><br>

    <label>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°:</label><br>
    <textarea name="details" rows="4" cols="50"></textarea><br><br>

    <button type="submit">‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
  </form>

  <div id="responseMessage"></div>

  <script>
    function getCurrentLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
          const lat = position.coords.latitude;
          const lng = position.coords.longitude;
          const gmapLink = `https://www.google.com/maps?q=${lat},${lng}`;
          document.getElementById('mapLinkInput').value = gmapLink;
        }, function(error) {
          alert("‚ùå ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡πÑ‡∏î‡πâ: " + error.message);
        });
      } else {
        alert("‚ùå ‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏ö‡∏∏‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á");
      }
    }

    function openMap() {
      const link = document.getElementById("mapLinkInput").value;
      if (link) {
        window.open(link, "_blank");
      } else {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ß‡∏≤‡∏á‡∏•‡∏¥‡∏á‡∏Å‡πå Google Maps ‡∏Å‡πà‡∏≠‡∏ô");
      }
    }

    const form = document.getElementById('serviceForm');
    form.addEventListener('submit', function (e) {
      e.preventDefault();

      const fileInput = document.getElementById("mediaFile");
      const file = fileInput.files[0];

      const formData = new FormData(form);

      if (file) {
        formData.append("mediaFile", file);
      }

      fetch('https://script.google.com/macros/s/AKfycbwYDYz5iWluIVoKpN3moORPGaB2CxANrrX1GNK9tH9CM22kDcM50aOTiNN4FHz9TCAk7g/exec', {
        method: 'POST',
        body: formData,
      })
      .then(res => res.text())
      .then(msg => {
        document.getElementById('responseMessage').innerText = msg;
        form.reset();
      })
      .catch(err => {
        console.error(err);
        document.getElementById('responseMessage').innerText = "‚ùå ‡∏°‡∏µ‡∏ö‡∏≤‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà";
      });
    });
  </script>
</body>
</html>
